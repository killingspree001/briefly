RewriteEngine On

# Explicitly tell Apache to use api/index.php for the root
DirectoryIndex api/index.php

# Allow access to the public directory for assets
RewriteCond %{REQUEST_URI} ^/public/ [OR]
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^ - [L]

# Route /api/summarize to the python script
RewriteRule ^api/summarize$ api/summarize.py [L]

# Route /archive to archive.php
RewriteRule ^archive$ api/archive.php [L]

# Route /seed to seed_client_demo.php
RewriteRule ^seed$ seed_client_demo.php [L]

# Route everything else (including root) to api/index.php
RewriteRule ^$ api/index.php [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ api/index.php [L]

# Fallback for servers that support it
FallbackResource /api/index.php
